Sub challenge()
    
    'Create summary table headers
    Range("I1").Value = "Ticker"
    Range("J1").Value = "Yearly Change"
    Range("K1").Value = "Percentage Change"
    Range("L1").Value = "Total Stock Volume"
    
    'create dynamic table headers
    Range("P1").Value = "Ticker"
    Range("Q1").Value = "Value"
    Cells(2, 15).Value = "Greatest % Increase"
    Cells(3, 15).Value = "Greatest % Decrease"
    Cells(4, 15).Value = "Greatest Total Volume"
    
    'set variables
    Dim ticker As String
    Dim date_value As Long
    Dim open_value As Double
    Dim close_value As Double
    Dim volume As Long
    Dim last_row As Long
    Dim ticker_counter As Integer
    
    last_row = 2000
    ticker_counter = 1

    For ticker_row = 2 To last_row
        ticker = Cells(ticker_row, 1)
        
        'compare current row to previous row to see if ticker is the same
        If Cells(ticker_row - 1, 1) <> ticker Then

            
        'compare current row to row in front to see if ticker is the same
        ElseIf Cells(ticker_row + 1, 1) <> ticker Then
            close_value = Cells(ticker_row, 6)
            volume = volume + Cells(ticker_row, 7)
            
        Else: volume = volume + Cells(ticker_row, 7)
        End If
        
        yearly_change = close_value - open_value
        
        Range("I" & ticker_counter) = ticker
        Range("J" & ticker_counter) = yearly_change
        Range("J:J").NumberFormat = "$0.00"
        Range("L" & ticker_counter) = volume
        
        If close_value = 0 Then
        ElseIf close_value <> 0 Then
            percentage_change = (close_value - open_value) / close_value
        Else 'do nothing
        End If
        
        Range("K" & ticker_counter) = percentage_change
        Range("K:K").NumberFormat = "0.00%"
        
    
    Next ticker_row
    
    For ticker_row_1 = 2 To last_row
    
        If Cells(ticker_row_1, 10) > 0 Then
        Cells(ticker_row_1, 10).Interior.ColorIndex = 4
        ElseIf Cells(ticker_row_1, 10) < 0 Then
        Cells(ticker_row_1, 10).Interior.ColorIndex = 3
        ElseIf Cells(ticker_row_1, 10) = 0 Then
        Cells(ticker_row_1, 10).Interior.ColorIndex = 2
        Else 'do nothing
        End If
        
        
    Next ticker_row_1
        

End Sub


